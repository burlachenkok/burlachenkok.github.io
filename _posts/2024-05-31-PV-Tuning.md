---
layout: post
title: PV-Tuning for Extreme LLM Compression
published: true
---

The new paper [PV-Tuning: Beyond Straight-Through Estimation for Extreme LLM Compression](https://arxiv.org/abs/2405.14852) with a new fine-tuning technique for highly-compressed LLMs has been published.

---

Our paper *PV-Tuning: Beyond Straight-Through Estimation for Extreme LLM Compression* has been published. 
We demonstrate that PV-tuning can improve quantized model accuracy for leading existing approaches, including GPTQ and AQLM.
PV-Tuning sets SOTA Post-Training LLM Quantization (PTQ) accuracy for 1-2.5 bitwidth.

The arXiv link for the paper: [https://arxiv.org/abs/2405.14852](https://arxiv.org/abs/2405.14852).

I was glad to work with my peers:
* [Dan Alistarh](https://ist.ac.at/en/research/alistarh-group/) from [IST Austria](https://ista.ac.at/en/home/), [NeuralMagic](https://neuralmagic.com/)
* [Ivan Ilin](https://ivan-ilin.netlify.app/), [Kai Yi](https://kaiyi.me/), [Peter Richtarik](https://richtarik.org/) from [KAUST AI Initiative](https://cemse.kaust.edu.sa/ai)
* [Vladimir Malinovskii](https://www.linkedin.com/in/vladimir-malinovskii-0871a51b4/), [Denis Kuznedelev](https://crei.skoltech.ru/ai/people/deniskuznedelev) from [Yandex](https://yandex.com/company/)
* [Denis Mazur](https://scholar.google.com/citations?user=rgDwAT0AAAAJ&hl=en) from [Moscow Institute of Physics and Technology](https://old.mipt.ru/english/)

----

# Abstract

There has been significant interest in "extreme" compression of large language models (LLMs), i.e., to 1-2 bits per parameter, which allows such models to be executed efficiently on resource-constrained devices. 

Existing work focused on improved one-shot quantization techniques and weight representations; yet, purely post-training approaches are reaching diminishing 
returns in terms of the accuracy-vs-bit-width trade-off. State-of-the-art quantization methods such as QuIP# and AQLM include fine-tuning (part of) 
the compressed parameters over a limited amount of calibration data; however, such fine-tuning techniques over compressed weights often make exclusive 
use of straight-through estimators (STE), whose performance is not well-understood in this setting. 

In this work, we question the use of STE for extreme LLM compression, showing that it can be sub-optimal, 
and perform a systematic study of quantization-aware fine-tuning strategies for LLMs. 

We propose PV-Tuning - a representation-agnostic framework that generalizes and improves upon existing fine-tuning strategies, 
and provides convergence guarantees in restricted cases. On the practical side, when used for 1-2 bit vector quantization, 
PV-Tuning outperforms prior techniques for highly-performant models such as Llama and Mistral. 
Using PV-Tuning, we achieve the first Pareto-optimal quantization for Llama 2 family models at 2 bits per parameter.

# Other links in Media

* Dan Alistarh's twitter post: [https://twitter.com/DAlistarh/status/1796530164215820766](https://twitter.com/DAlistarh/status/1796530164215820766)
* Peter Richtarik mentioning in the news: [https://richtarik.org/index.html](https://richtarik.org/index.html)
* The official implementation: [https://github.com/Vahe1994/AQLM/tree/pv-tuning](https://github.com/Vahe1994/AQLM/tree/pv-tuning)

---

<table style="text-align:center;">
<tr>
<td style="padding:15px;text-align:center;vertical-align:middle;"> <img height="95px" src="https://burlachenkok.github.io/materials/KAUST-logo.svg"/> </td> 
<td style="padding:15px;text-align:center;vertical-align:middle;"> <img height="95px" src="https://burlachenkok.github.io/materials/mipt-logo.svg"/> </td>
<td style="padding:15px;text-align:center;vertical-align:middle;"> <img height="85px" src="https://burlachenkok.github.io/materials/Yandex_Logo.svg"/> </td>
<td style="padding:15px;text-align:center;vertical-align:middle;"> <img height="85px" src="https://burlachenkok.github.io/materials/ISTA_Logo_4c_rgb.svg"/> </td>
<td style="padding:15px;text-align:center;vertical-align:middle;"> <img height="85px" src="https://burlachenkok.github.io/materials/neural-magic.svg"/> </td>
</tr>
</table>
